
# python 3.6 在线安装

## Ubuntu

> [原文链接](http://pythonguidecn.readthedocs.io/zh/latest/starting/install3/linux.html)

如果您使用的是 Ubuntu 16.10 或更新版本，可以通过以下命令简单地安装 Python 3.6:

```
$ sudo apt-get update
$ sudo apt-get install python3.6
```

如果您使用的是其他版本的 Ubuntu（比如LTS发行版），我们推荐使用 [deadsnakes PPA](https://launchpad.net/~deadsnakes/+archive/ubuntu/ppa) 来安装 Python 3.6:

```
$ sudo apt-get install software-properties-common
$ sudo add-apt-repository ppa:deadsnakes/ppa
$ sudo apt-get update
$ sudo apt-get install python3.6
```

[pip 安装](https://pip.pypa.io/en/latest/installing/)

## centos7

> [原文链接](https://janikarhunen.fi/how-to-install-python-3-6-1-on-centos-7.html)

首先安装必要的程序

``` bash
sudo yum update
sudo yum install yum-utils
sudo yum groupinstall development
```

安装 Python 3.6

标准的 yum 版本库还没有提供最新的 Python 版本，所以我需要安装一个名为 IUM（Inline with Upstream Stable）的附加版本库，它提供了必要的 RPM 软件包。

``` bash
sudo yum install https://centos7.iuscommunity.org/ius-release.rpm
```

现在安装了 repository ，我可以继续安装 Python 3.6：

``` bash
sudo yum install python36u
```

现在是检查 Python 版本的时候了

``` bash
python3.6 -V
```

接下来是 pip 和一些开发包。

``` bash
sudo yum install python36u-pip
sudo yum install python36u-devel
```

# python 3.6 源码安装

下载源码包

复制到 opt 目录

添加配置

``` bash
./configure
```

也可以指定安装目录

```
./configure --prefix=/usr/bin/python3.6
```

编译源码

``` bash
sudo make
```

执行安装 

``` bash
sudo make install 
```

创建一个别名方便使用

修改 `～/.profile` 文件

```
alias py3="/xxxxxx/python3.6"
```

## 如果安装完成后 pip 无法安装模块，报 SSL 相关错误，请重新按照以下步骤安装

首先安装 openssl 和 libssl-dev(centos 安装 openssl-devel 还有 `yum install -y openssl-static`)

再重新配置安装

``` bash
./configure --with-ssl

sudo make

sudo make install
```


通过国内镜像安装模块

举个栗子
``` bash
pip install Django -i https://pypi.douban.com/simple
```

## 如果 python3.6 无法使用 sqlite3 ，请手动安装

首先安装 libsqlite3-dev和 sqlite3 (centos 上是 sqlite-devel)  

再重新配置安装 python3.6，方法同上

## 安装 mysqlclient

如果报错，请先安装 libmysqlclient-dev ：

``` bash
sudo apt install libmysqlclient-dev

# centos
yum install python-devel mysql-devel -y

```
然后再安装：

``` bash
pip install mysqlclient
```

##  使用 mysql 时报错 "Unknown system variable 'storage_engine'"

请将名称换成
``` bash
default_storage_engine
```

## centos 安装 gcc

``` bash
yum install -y gcc wget
yum groupinstall "Development tools"
yum install zlib-devel bzip2-devel openssl-devel ncurses-devel sqlite-devel readline-devel tk-devel gdbm-devel db4-devel libpcap-devel xz-devel
```

## pip 升级 10.x 报错

```
jianxin@ubuntu:/usr/bin$ pip3
Traceback (most recent call last):
  File "/usr/bin/pip3", line 9, in <module>
    from pip import main
ImportError: cannot import name 'main'
```

修改 `/usr/bin/pip3` 文件如下：

``` python
#!/usr/bin/python3
# GENERATED BY DEBIAN

import sys

# Run the main entry point, similarly to how setuptools does it, but because
# we didn't install the actual entry point from setup.py, don't use the
# pkg_resources API.
from pip import __main__
if __name__ == '__main__':
    sys.exit(__main__._main())

```

# virtualenv + virtualenvwrapper

## 安装 virtualenv

``` bash
sudo apt install python-virtualenv
```

建立 python 虚拟环境
用 -p 参数指定 python 版本
``` bash
virtualenv -p python3 testenv
```

进入虚拟环境

```
source testenv/bin/activate
```

成功进入的标志
```
(testenv) jianxin@ubuntu:~/pycode$ 
```

## 安装 virtualenvwrapper

```
sudo pip install virtualenvwrapper
```

在 `.bashrc` (或 `.zshrc` ) 中添加下列内容：

```
export WORKON_HOME=$HOME/.virtualenvs
source /usr/local/bin/virtualenvwrapper.sh
```

!> virtualenvwrapper.sh 文件可能在其他地方

使修改生效

```
source ~/.bashrc # (或~/.zshrc)。
```
### 使用
 * `workon`: 打印所有的虚拟环境；  
 * `mkvirtualenv xxx`: 创建 xxx 虚拟环境;  
 * `workon xxx`: 使用 xxx 虚拟环境;  
 * `deactivate`: 退出 xxx 虚拟环境；  
 * `rmvirtualenv xxx`: 删除 xxx 虚拟环境。  

# pipenv

## 安装

使用 pip 

```
$ pip install pipenv
```

如果你使用的是 Ubuntu 17.10:

```
$ sudo apt install software-properties-common python-software-properties
$ sudo add-apt-repository ppa:pypa/ppa
$ sudo apt update
$ sudo apt install pipenv
```

mac

```
$ brew install pipenv
```

## options

```
pipenv [OPTIONS] COMMAND [ARGS]...
```

| OPTIONS | 解释
|:--------|:--------
| `--where` | 查看项目位置
| `--venv` | 查看 virtualenv 位置
| `--py` | 查看 Python 解释器位置
| `--envs` | 查看环境变量选项。
| `--rm` | 删除 virtualenv
| `--three`, `--two` | 创建 virtualenv 时使用 Python3 还是 Python2
| `--python <python>` | 指定 virtualenv 应该使用哪个版本的 Python
| `--version` | 显示版本

## COMMAND

| COMMAND | 解释
|:--------|:--------
| `check` | 检查软件包的完整性
| `graph` | 查看依赖树
| `install` | `pipenv install [OPTIONS] [PACKAGE_NAME] [MORE_PACKAGES]...` <br><br> `-d`: 安装到 `[dev-packages]` <br><br> `-r <requirements>`: 安装 requirements 文件中的所有包
| `shell` | 进入 virtualenv <br> <br> 注意：退出请使用 `exit`，不要使用 `deactivate`
| `uninstall` | 卸载软件包
| `update` | 这个命令会删除所有软件包然后重新安装最新的版本。
| `run` | 使用 virtualenv 运行命令 <br> <br> 例如：`pipenv run python main.py`

## 换源

更换到豆瓣的 pipy 源

```
sed -i s/pypi.org/pypi.doubanio.com/g Pipfile
```

# requirements.txt

pipenv 生成 requirements.txt 文件

```
pipenv lock -r [--dev] > requirements.txt
```

pipenv 安装 requirements.txt 文件中的所有包

```
pipenv install -r requirements.txt
```

pip 生成 requirements.txt 文件

```
pip freeze > requirements.txt
```

pip 安装 requirements.txt 文件中的所有包

```
pip install -r requirements.txt
```
